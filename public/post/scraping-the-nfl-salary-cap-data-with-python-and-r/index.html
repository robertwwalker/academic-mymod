<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.58.3" />
  <meta name="author" content="Robert W. Walker">

  
  
  
  
    
      
    
  
  <meta name="description" content="The NFL Data [SporTrac](http://www.sportrac.com] has a wonderful array of financial data on sports. A student going to work for the Seattle Seahawks wanted the NFL salary cap data and I also found data on the English Premier League there. Now I have a source to scrape the data from.
With a source in hand, the key tool is the SelectorGadget. SelectorGadget is a browser add-in for Chrome that allows us to select text and identify the css or xpath selector to scrape the data.">

  
  <link rel="alternate" hreflang="en-us" href="/post/scraping-the-nfl-salary-cap-data-with-python-and-r/">

  



  
  
  <meta name="theme-color" content="">
  
  
  
  
    
  
  
    
    
      
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js//styles/dracula.min.css">
      
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/%!s(<nil>)/css/bootstrap.min.css" integrity="%!s(<nil>)" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/%!s(<nil>)/css/academicons.min.css" integrity="%!s(<nil>)" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/%!s(<nil>)/css/font-awesome.min.css" integrity="%!s(<nil>)" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/%!s(<nil>)/jquery.fancybox.min.css" integrity="%!s(<nil>)" crossorigin="anonymous">
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/%!s(<nil>)/leaflet.css" integrity="%!s(<nil>)" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="/styles.css">
  

  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Robert W. Walker">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="Robert W. Walker">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/scraping-the-nfl-salary-cap-data-with-python-and-r/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@PieRatio">
  <meta property="twitter:creator" content="@PieRatio">
  
  <meta property="og:site_name" content="Robert W. Walker">
  <meta property="og:url" content="/post/scraping-the-nfl-salary-cap-data-with-python-and-r/">
  <meta property="og:title" content="Scraping the NFL Salary Cap Data with Python and R | Robert W. Walker">
  <meta property="og:description" content="The NFL Data [SporTrac](http://www.sportrac.com] has a wonderful array of financial data on sports. A student going to work for the Seattle Seahawks wanted the NFL salary cap data and I also found data on the English Premier League there. Now I have a source to scrape the data from.
With a source in hand, the key tool is the SelectorGadget. SelectorGadget is a browser add-in for Chrome that allows us to select text and identify the css or xpath selector to scrape the data.">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-04-04T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2018-04-04T00:00:00&#43;00:00">
  

  

  <title>Scraping the NFL Salary Cap Data with Python and R | Robert W. Walker</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" class="dark">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/"><img src="/img/headers/wuagsm.jpg" alt="Robert W. Walker"></a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#publications_selected">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/img/vita.pdf">
            
            <span>Curriculum Vitae</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        
        
        
        
        

        <li class="nav-item">
          <a href="/r">
            
            <span>R Stuff</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">Scraping the NFL Salary Cap Data with Python and R</h1>

    

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2018-04-04 00:00:00 &#43;0000 UTC" itemprop="datePublished dateModified">
      2018-04-04
    </time>
  </span>
  <span itemscope itemprop="author publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Robert W. Walker">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    9 min read
  </span>
  

  
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/categories/r">R</a
    >, 
    
    <a href="/categories/tidyverse">tidyverse</a
    >, 
    
    <a href="/categories/python">python</a
    >, 
    
    <a href="/categories/reticulate">reticulate</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Scraping%20the%20NFL%20Salary%20Cap%20Data%20with%20Python%20and%20R&amp;url=%2fpost%2fscraping-the-nfl-salary-cap-data-with-python-and-r%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2fscraping-the-nfl-salary-cap-data-with-python-and-r%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2fscraping-the-nfl-salary-cap-data-with-python-and-r%2f&amp;title=Scraping%20the%20NFL%20Salary%20Cap%20Data%20with%20Python%20and%20R"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2fscraping-the-nfl-salary-cap-data-with-python-and-r%2f&amp;title=Scraping%20the%20NFL%20Salary%20Cap%20Data%20with%20Python%20and%20R"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Scraping%20the%20NFL%20Salary%20Cap%20Data%20with%20Python%20and%20R&amp;body=%2fpost%2fscraping-the-nfl-salary-cap-data-with-python-and-r%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


    <div class="article-style" itemprop="articleBody">
      


<div id="the-nfl-data" class="section level1">
<h1>The NFL Data</h1>
<p>[SporTrac](<a href="http://www.sportrac.com" class="uri">http://www.sportrac.com</a>] has a wonderful array of financial data on sports. A student going to work for the Seattle Seahawks wanted the NFL salary cap data and I also found data on the English Premier League there. Now I have a source to scrape the data from.</p>
<p>With a source in hand, the key tool is the <em>SelectorGadget</em>. <em>SelectorGadget</em> is a browser add-in for Chrome that allows us to select text and identify the css or xpath selector to scrape the data. With that, it becomes easy to identify what we need. I navgiated to the website in base_url and found the team names had links to the cap data. I will use those links first. Let’s build that.</p>
<pre class="r"><code>library(rvest)
base_url &lt;- &quot;http://www.spotrac.com/nfl/&quot;
read.base &lt;- read_html(base_url)
team.URL &lt;- read.base %&gt;% html_nodes(&quot;.team-name&quot;) %&gt;% html_attr(&#39;href&#39;)
team.URL</code></pre>
<pre><code>##  [1] &quot;https://www.spotrac.com/nfl/arizona-cardinals/cap/&quot;   
##  [2] &quot;https://www.spotrac.com/nfl/atlanta-falcons/cap/&quot;     
##  [3] &quot;https://www.spotrac.com/nfl/baltimore-ravens/cap/&quot;    
##  [4] &quot;https://www.spotrac.com/nfl/buffalo-bills/cap/&quot;       
##  [5] &quot;https://www.spotrac.com/nfl/carolina-panthers/cap/&quot;   
##  [6] &quot;https://www.spotrac.com/nfl/chicago-bears/cap/&quot;       
##  [7] &quot;https://www.spotrac.com/nfl/cincinnati-bengals/cap/&quot;  
##  [8] &quot;https://www.spotrac.com/nfl/cleveland-browns/cap/&quot;    
##  [9] &quot;https://www.spotrac.com/nfl/dallas-cowboys/cap/&quot;      
## [10] &quot;https://www.spotrac.com/nfl/denver-broncos/cap/&quot;      
## [11] &quot;https://www.spotrac.com/nfl/detroit-lions/cap/&quot;       
## [12] &quot;https://www.spotrac.com/nfl/green-bay-packers/cap/&quot;   
## [13] &quot;https://www.spotrac.com/nfl/houston-texans/cap/&quot;      
## [14] &quot;https://www.spotrac.com/nfl/indianapolis-colts/cap/&quot;  
## [15] &quot;https://www.spotrac.com/nfl/jacksonville-jaguars/cap/&quot;
## [16] &quot;https://www.spotrac.com/nfl/kansas-city-chiefs/cap/&quot;  
## [17] &quot;https://www.spotrac.com/nfl/los-angeles-chargers/cap/&quot;
## [18] &quot;https://www.spotrac.com/nfl/los-angeles-rams/cap/&quot;    
## [19] &quot;https://www.spotrac.com/nfl/miami-dolphins/cap/&quot;      
## [20] &quot;https://www.spotrac.com/nfl/minnesota-vikings/cap/&quot;   
## [21] &quot;https://www.spotrac.com/nfl/new-england-patriots/cap/&quot;
## [22] &quot;https://www.spotrac.com/nfl/new-orleans-saints/cap/&quot;  
## [23] &quot;https://www.spotrac.com/nfl/new-york-giants/cap/&quot;     
## [24] &quot;https://www.spotrac.com/nfl/new-york-jets/cap/&quot;       
## [25] &quot;https://www.spotrac.com/nfl/oakland-raiders/cap/&quot;     
## [26] &quot;https://www.spotrac.com/nfl/philadelphia-eagles/cap/&quot; 
## [27] &quot;https://www.spotrac.com/nfl/pittsburgh-steelers/cap/&quot; 
## [28] &quot;https://www.spotrac.com/nfl/san-francisco-49ers/cap/&quot; 
## [29] &quot;https://www.spotrac.com/nfl/seattle-seahawks/cap/&quot;    
## [30] &quot;https://www.spotrac.com/nfl/tampa-bay-buccaneers/cap/&quot;
## [31] &quot;https://www.spotrac.com/nfl/tennessee-titans/cap/&quot;    
## [32] &quot;https://www.spotrac.com/nfl/washington-redskins/cap/&quot;</code></pre>
<pre class="r"><code># Clean up the URLs to get the team names by themselves.
team.names &lt;- gsub(&quot;/cap/&quot;,&quot;&quot;, gsub(base_url, &quot;&quot;, team.URL))</code></pre>
<p>With 32 team links to scrape, I can now scrape them.</p>
<div id="grabbing-team-tables" class="section level2">
<h2>Grabbing Team Tables</h2>
<p>Now I need to explore those links. When I started this, I wanted to learn some Python along the way. I found the following <a href="https://wcontractor.github.io/nfl-salary-part2.html">Python code</a> that worked for the task. For completeness, I leave it here.</p>
<pre class="python"><code>import pandas as pd
import bs4
import re
import urllib2
#import requests

from urllib import urlopen
from bs4 import BeautifulSoup
base_url = &quot;http://www.spotrac.com/nfl/&quot;

def get_page(url):
    page = urlopen(base_url)
    soup = BeautifulSoup(page, &#39;lxml&#39;)
    file = open(&quot;spotrac_urls.txt&quot;, &#39;w&#39;)
    file.write(str(soup))
    file.close()

def get_team_table(url):
    page = urlopen(url)
    soup = BeautifulSoup(page, &#39;lxml&#39;)

get_page(base_url)

with open(&quot;spotrac_urls.txt&quot;, &#39;r&#39;) as file:
    for line in file:
        line = line.strip()

from bs4 import BeautifulSoup
page = open(&quot;spotrac_urls.txt&quot;, &#39;r&#39;)
soup = BeautifulSoup(page, &quot;lxml&quot;)
div = soup.find(&quot;div&quot;,&quot;subnav-posts&quot;)

links = div.find_all(&#39;a&#39;)
for link in links:
    print(link.get(&#39;href&#39;))

len(links)

def get_team_table(url):
    page = urlopen(url)
    soup = BeautifulSoup(page, &#39;lxml&#39;)
    data_rows = [row for row in soup.find(&quot;table&quot;, &quot;datatable&quot;).find_all(&quot;tr&quot;)]
    return data_rows

# create an empty list
team_data = []

for link in links:
    team_data.append(get_team_table(link.get(&#39;href&#39;)))

len(team_data)

#data_rows = [row for row in soup.find(&quot;td&quot;, &quot;center&quot;).find_all(&quot;tr&quot;)]
table_data = []

#soup = BeautifulSoup(team_data[0], &#39;lxml&#39;)

#This needs to be a nested for loop because inner items of the list are BeautifulSoup Elements
for row in team_data:
    for element in row:
        #print(type(element))
        if soup.find_all(&quot;td&quot;, attrs={&quot;class&quot;:&quot; right xs-hide &quot;}) is not None:
            table_data.append(element.get_text())

player_data = []
for row in table_data:
    player_data.append(row.split(&quot;\n&quot;))
    #print(player_data)

len(player_data)

import pandas as pd
df = pd.DataFrame(player_data)
df = df.drop(14, 1)
df = df.drop(0, 1)
df = df.drop(1, 1)


df = df.drop(df.index[[0]])
df.set_index(1, inplace=True)
print(df.shape)
df.head()

players = []
for row in team_data[0]:
    if row.get_text(&quot;tr&quot;) is not None:
        players.append(row) 

column_headers = [col.get_text() for col in players[0].find_all(&quot;th&quot;) if col.get_text()]
len(column_headers)

df.columns = column_headers
df.head()

#The header repeated itself in the data.  This didn&#39;t reveal itself until the data type conversion step below
#but this fixes all occurrences of it.
rows_to_be_dropped = df.loc[df[&#39;Cap Hit&#39;] == &#39;Cap %&#39;].index
rows_to_be_kept = df.loc[df[&#39;Cap Hit&#39;] != &#39;Cap %&#39;].index
totlen = len(df)
df2a = df.drop(rows_to_be_kept)
df = df.drop(rows_to_be_dropped)
df2 = pd.Series(data=rows_to_be_dropped)

#Apply a regex to convert the &#39;Cap Hit&#39; column from a string to a float.  
# df[&#39;Cap Hit&#39;] =(df[&#39;Cap Hit&#39;].replace(&#39;[\$,)]&#39;, &quot;&quot;, regex=True).replace( &#39;[(]&#39;,&#39;-&#39;,   regex=True ).astype(float))

# My fix
df[&#39;Cap.Hit&#39;] = (df[&#39;Cap Hit&#39;].replace(&#39;[\$,)]&#39;, &quot;&quot;, regex=True).replace(&#39;[-,)]&#39;, &quot;&quot;, regex=True).replace(&#39;\s\s.*&#39;, &quot;&quot;, regex=True).astype(float))
df[&#39;Base.Salary&#39;] = (df[&#39;Base Salary&#39;].replace(&#39;[\$,)]&#39;, &quot;&quot;, regex=True).replace(&#39;[-,)]&#39;, &quot;&quot;, regex=True).astype(float))
df[&#39;Signing.Bonus&#39;] = (df[&#39;Signing Bonus&#39;].replace(&#39;[\$,)]&#39;, &quot;&quot;, regex=True).replace(&#39;[-,)]&#39;, &quot;&quot;, regex=True).astype(float))
df[&#39;Roster.Bonus&#39;] = (df[&#39;Roster Bonus&#39;].replace(&#39;[\$,)]&#39;, &quot;&quot;, regex=True).replace(&#39;[-,)]&#39;, &quot;&quot;, regex=True).astype(float))
df[&#39;Option.Bonus&#39;] = (df[&#39;Option Bonus&#39;].replace(&#39;[\$,)]&#39;, &quot;&quot;, regex=True).replace(&#39;[-,)]&#39;, &quot;&quot;, regex=True).astype(float))
df[&#39;Workout.Bonus&#39;] = (df[&#39;Workout Bonus&#39;].replace(&#39;[\$,)]&#39;, &quot;&quot;, regex=True).replace(&#39;[-,)]&#39;, &quot;&quot;, regex=True).astype(float))
df[&#39;Restruc.Bonus&#39;] = (df[&#39;Restruc. Bonus&#39;].replace(&#39;[\$,)]&#39;, &quot;&quot;, regex=True).replace(&#39;[-,)]&#39;, &quot;&quot;, regex=True).astype(float))
df[&#39;Misc&#39;] = (df[&#39;Misc.&#39;].replace(&#39;[\$,)]&#39;, &quot;&quot;, regex=True).replace(&#39;[-,)]&#39;, &quot;&quot;, regex=True).astype(float))
df[&#39;Dead.Cap&#39;] = (df[&#39;Dead Cap&#39;].replace(&#39;\(&#39;,&quot;&quot;,regex=True).replace(&#39;\)&#39;,&quot;&quot;,regex=True).replace(&#39;[\$,)]&#39;, &quot;&quot;, regex=True).replace(&#39;[-,)]&#39;, &quot;&quot;, regex=True).astype(float))

#Sanity check to make sure it worked.
df[&#39;Cap Hit&#39;].sum()</code></pre>
<p>There are a few wonderful things about Beautiful Soup. But it is still faster and easier for me to do things in R. Here is some R code for the same task. The R table is a messy data structure but is easier to get.</p>
<pre class="r"><code>library(stringr)
data.creator &lt;- function(link) {
read_html(link) %&gt;% html_nodes(&quot;table&quot;) %&gt;% html_table(header=TRUE, fill=TRUE) -&gt; res
names(res) &lt;- c(&quot;Active&quot;,&quot;Draft&quot;,&quot;Inactive&quot;,&quot;Team1&quot;,&quot;Team2&quot;)
return(res)
  }
team.names &lt;- gsub(&quot;-&quot;, &quot; &quot;, team.names)
simpleCap &lt;- function(x) {
  s &lt;- strsplit(x, &quot; &quot;)[[1]]
  paste(toupper(substring(s, 1,1)), substring(s, 2),
      sep=&quot;&quot;, collapse=&quot; &quot;)
}
team.names &lt;- sapply(team.names, simpleCap)
NFL.scrape &lt;- sapply(team.URL, function(x) {data.creator(x)})
names(NFL.scrape) &lt;- team.names 
# This is a hack but it works
Actives &lt;- lapply(NFL.scrape, function(x){x$Active})
rep.res &lt;- sapply(seq(1,32), function(x) {dim(Actives[[x]])[[1]]})
clean.me.2 &lt;- function(data) {
data %&gt;% str_remove_all(&quot;[\\t]&quot;) %&gt;% str_split(&quot;\\n\\n\\n&quot;) %&gt;% unlist() %&gt;% matrix(data=., ncol=2, byrow=TRUE) -&gt; dat
return(dat)
}
clean.me &lt;- function(data) {
str_remove_all(data, &quot;[\\t]&quot;)
}
clean.me.num &lt;- function(data) {
str_remove_all(data, &quot;[\\$,()\\-]&quot;)
  }
Players &lt;- lapply(Actives, function(x){ clean.me.2(x[,1])})
Last.Name &lt;- unlist(lapply(Players, function(x) {x[,1]}))
Player.Name &lt;- unlist(lapply(Players, function(x) {x[,2]}))
Team &lt;- rep(names(Actives),rep.res)
Position &lt;- unlist(lapply(Actives, function(x){ clean.me(x[,2])}))
Base.Salary &lt;- unlist(lapply(Actives, function(x){ clean.me.num(x[,&#39;Base Salary&#39;])}))
Base.Salary &lt;- as.numeric(Base.Salary)
Signing.Bonus &lt;- unlist(lapply(Actives, function(x){ clean.me.num(x[,&#39;Signing Bonus&#39;])}))
Signing.Bonus &lt;- as.numeric(Signing.Bonus)
Roster.Bonus &lt;- unlist(lapply(Actives, function(x){ clean.me.num(x[,&#39;Roster Bonus&#39;])}))
Roster.Bonus &lt;- as.numeric(Roster.Bonus)
Option.Bonus &lt;- unlist(lapply(Actives, function(x){ clean.me.num(x[,&#39;Option Bonus&#39;])}))
Option.Bonus &lt;- as.numeric(Option.Bonus)
Workout.Bonus &lt;- unlist(lapply(Actives, function(x){ clean.me.num(x[,&#39;Workout Bonus&#39;])}))
Workout.Bonus &lt;- as.numeric(Workout.Bonus)
Cap.Pct &lt;- unlist(lapply(Actives, function(x){ x[,&#39;Cap %&#39;]}))
Restruc.Bonus &lt;- unlist(lapply(Actives, function(x){ clean.me.num(x[,&#39;Restruc. Bonus&#39;])}))
Restruc.Bonus &lt;- as.numeric(Restruc.Bonus)
Dead.Cap &lt;- unlist(lapply(Actives, function(x){ clean.me.num(x[,&#39;Dead Cap&#39;])}))
Dead.Cap &lt;- as.numeric(Dead.Cap)
Misc.Cap &lt;- unlist(lapply(Actives, function(x){ clean.me.num(x[,&#39;Misc.&#39;])}))
Misc.Cap &lt;- as.numeric(Misc.Cap)
Cap.Hit &lt;- unlist(lapply(Actives, function(x){ clean.me.num(x[,&#39;Cap Hit&#39;])}))
Cap.Hit &lt;- str_replace_all(Cap.Hit, pattern=&quot;\\s\\s*&quot;, &quot;&quot;)
NFL.Salary.Data &lt;- data.frame(Player=Player.Name, 
                       Last.Name = Last.Name,
                       Team=Team, 
                       Position=Position, 
                       Base.Salary=Base.Salary,
                       Signing.Bonus=Signing.Bonus,
                       Roster.Bonus=Roster.Bonus,
                       Option.Bonus=Option.Bonus,
                       Workout.Bonus=Workout.Bonus,
                       Cap.Hit=Cap.Hit,
                       Restruc.Bonus=Restruc.Bonus,
                       Dead.Cap=Dead.Cap,
                       Misc.Cap=Misc.Cap,
                       Cap.Pct=Cap.Pct)
save.image(&quot;~/NFL-Data.RData&quot;)</code></pre>
<p>Load up a local copy of the data for now.</p>
<pre class="r"><code>load(url(&quot;https://github.com/robertwwalker/academic-mymod/raw/master/data/NFL-Data.RData&quot;))</code></pre>
</div>
<div id="summaries" class="section level2">
<h2>Summaries</h2>
<pre class="r"><code>library(tidyverse)
library(skimr)
skim(NFL.Salary.Data)</code></pre>
<pre><code>## Skim summary statistics
##  n obs: 2239 
##  n variables: 14 
## 
## ── Variable type:factor ──────────────────────────────────────────────────────────────────
##   variable missing complete    n n_unique
##    Cap.Hit       0     2239 2239     1043
##  Last.Name       0     2239 2239     1489
##     Player       0     2239 2239     2226
##   Position       0     2239 2239       22
##       Team       0     2239 2239       32
##                             top_counts ordered
##  480: 279, 555: 230, 630: 185, 705: 66   FALSE
##     Jon: 41, Wil: 39, Smi: 31, Joh: 30   FALSE
##         Aus: 2, Bra: 2, Bra: 2, Chr: 2   FALSE
##    WR: 289, CB: 242, DE: 179, OLB: 171   FALSE
##     New: 86, Ind: 78, New: 78, Cle: 77   FALSE
## 
## ── Variable type:numeric ─────────────────────────────────────────────────────────────────
##       variable missing complete    n       mean         sd p0       p25
##    Base.Salary       0     2239 2239 1702378.82 2559999.2   0 555000   
##        Cap.Pct       0     2239 2239       1.36       2.05  0      0.31
##       Dead.Cap       0     2239 2239 2237274.35 5646281.55  0      0   
##       Misc.Cap       0     2239 2239    9149.17   81182.62  0      0   
##   Option.Bonus       0     2239 2239   13272.29  168050.78  0      0   
##  Restruc.Bonus       0     2239 2239   44915.31  341687.19  0      0   
##   Roster.Bonus       0     2239 2239  206966.64 1021892.52  0      0   
##  Signing.Bonus       0     2239 2239  449440.82  961034.55  0      0   
##  Workout.Bonus       0     2239 2239   20166.59   76589.41  0      0   
##        p50        p75        p100     hist
##  700000    1500000    22500000    ▇▁▁▁▁▁▁▁
##       0.41       1.42       18.02 ▇▁▁▁▁▁▁▁
##   50178    1330354.5  82500000    ▇▁▁▁▁▁▁▁
##       0          0     2085000    ▇▁▁▁▁▁▁▁
##       0          0     4750000    ▇▁▁▁▁▁▁▁
##       0          0     5561666    ▇▁▁▁▁▁▁▁
##       0          0    28800000    ▇▁▁▁▁▁▁▁
##    3333     397413.5  10500000    ▇▁▁▁▁▁▁▁
##       0          0     1335000    ▇▁▁▁▁▁▁▁</code></pre>
<pre class="r"><code>NFL.Salary.Data %&gt;% group_by(Team) %&gt;% summarise(Total.Base.Salary=sum(Base.Salary))</code></pre>
<pre><code>## # A tibble: 32 x 2
##    Team               Total.Base.Salary
##    &lt;fct&gt;                          &lt;dbl&gt;
##  1 Arizona Cardinals          105629569
##  2 Atlanta Falcons            132367353
##  3 Baltimore Ravens           111906351
##  4 Buffalo Bills               94577460
##  5 Carolina Panthers          110158355
##  6 Chicago Bears               85128180
##  7 Cincinnati Bengals         134855807
##  8 Cleveland Browns           122139767
##  9 Dallas Cowboys             128347113
## 10 Denver Broncos             140672444
## # … with 22 more rows</code></pre>
<pre class="r"><code>NFL.Salary.Data %&gt;% group_by(Position) %&gt;% skim(Base.Salary)</code></pre>
<pre><code>## Skim summary statistics
##  n obs: 2239 
##  n variables: 14 
##  group variables: Position 
## 
## ── Variable type:numeric ─────────────────────────────────────────────────────────────────
##  Position    variable missing complete   n       mean         sd     p0
##         C Base.Salary       0       62  62 1964378.97 2173761.05      0
##        CB Base.Salary       0      242 242 1594781.37 2433196.22      0
##        DE Base.Salary       0      179 179 2007139.09 3065728.54      0
##        DT Base.Salary       0      143 143 2014004.03 3128524.16      0
##        FB Base.Salary       0       26  26  815000     560564         0
##        FS Base.Salary       0       57  57 2641985.07 2783070.36      0
##         G Base.Salary       0      136 136 1704599.21 2115607.14      0
##       ILB Base.Salary       0      120 120 1378939.22 1901654.33      0
##         K Base.Salary       0       38  38 1383498.11  946083.47 480000
##        LB Base.Salary       0        1   1  616500         NA    616500
##        LS Base.Salary       0       34  34  761617.65  201707.56 480000
##        LT Base.Salary       0       38  38 4587732.76 4142986.8       0
##       OLB Base.Salary       0      171 171 1938283.55 2869077.82      0
##         P Base.Salary       0       37  37 1242027.03  803853.93 480000
##        QB Base.Salary       0       96  96 3408382.24 5078200.92      0
##        RB Base.Salary       0      151 151 1088425.34 1459116.95      0
##        RT Base.Salary       0       52  52 2314986.23 1962841.68      0
##         S Base.Salary       0       68  68  576320.49  123126.23      0
##        SS Base.Salary       0       53  53 1566535.64 1521405.49      0
##         T Base.Salary       0       94  94  587082.02  222252.32 480000
##        TE Base.Salary       0      152 152 1301806.18 1570488.64 480000
##        WR Base.Salary       0      289 289 1624579.17 2486576.11      0
##        p25       p50     p75     p100     hist
##  630000     862290.5 2693750  9000000 ▇▁▂▁▁▁▁▁
##  555000     630000   1329725 13500000 ▇▁▁▁▁▁▁▁
##  555000     790000   1812276 17143000 ▇▁▁▁▁▁▁▁
##  555000     630000   1760393 16985000 ▇▁▁▁▁▁▁▁
##  555000     667500    837500  2750000 ▂▇▆▁▂▁▁▁
##  762911    1426150   3250000 11287000 ▇▃▁▁▁▁▁▁
##  555000     790000   1880750 10000000 ▇▂▁▁▁▁▁▁
##  555000     705000   1049127 10000000 ▇▁▁▁▁▁▁▁
##  555000     899464   2037500  3400000 ▇▁▁▁▂▁▁▁
##  616500     616500    616500   616500 ▁▁▁▇▁▁▁▁
##  573750     790000    915000  1100000 ▇▃▂▃▂▅▆▁
##  961056.25 2310342   8825000 12496000 ▇▂▁▂▁▂▂▂
##  555000     705000   1639242 14750000 ▇▁▁▁▁▁▁▁
##  555000    1000000   1500000  3000000 ▇▂▃▁▁▂▁▂
##  592500     831832   3242341 22500000 ▇▁▁▁▁▁▁▁
##  555000     630000   1000000 14544000 ▇▁▁▁▁▁▁▁
##  768750    1897621   3918750  9341000 ▇▅▂▃▁▁▁▁
##  480000     555000    630000  1037723 ▁▁▁▃▇▁▁▁
##  630000     875000   1750000  6800000 ▇▃▁▁▁▁▁▁
##  480000     555000    630000  2312212 ▇▁▁▁▁▁▁▁
##  555000     630000   1048771  8250000 ▇▁▁▁▁▁▁▁
##  555000     630000   1200000 15982000 ▇▁▁▁▁▁▁▁</code></pre>
<p>Now I have my salary data.</p>
<pre class="r"><code>gplots::plotmeans(Base.Salary~Position, data=NFL.Salary.Data, n.label=FALSE, cex=0.6)</code></pre>
<p><img src="/post/2018-04-04-scraping-the-nfl-salary-cap-data-with-python-and-r_files/figure-html/Plot-1.png" width="672" /></p>
<pre class="r"><code>boxplot(Base.Salary~Position, data=NFL.Salary.Data)</code></pre>
<p><img src="/post/2018-04-04-scraping-the-nfl-salary-cap-data-with-python-and-r_files/figure-html/Plot2-1.png" width="672" /></p>
</div>
<div id="combining-and-categorizing-data" class="section level2">
<h2>Combining and Categorizing Data</h2>
<pre class="r"><code>NFL.Salary.Data$Pos.Char &lt;- NFL.Salary.Data$SideOfBall &lt;- NFL.SubTeam &lt;- as.character(NFL.Salary.Data$Position)
O.Line &lt;- c(&quot;LT&quot;,&quot;RT&quot;,&quot;C&quot;,&quot;G&quot;,&quot;T&quot;)
D.Line &lt;- c(&quot;DT&quot;,&quot;DE&quot;)
LineBackers &lt;- c(&quot;LB&quot;,&quot;ILB&quot;,&quot;OLB&quot;)
Safeties &lt;- c(&quot;S&quot;,&quot;SS&quot;,&quot;FS&quot;)
CBs &lt;- c(&quot;CB&quot;)
Special.Teams &lt;- c(&quot;K&quot;,&quot;P&quot;,&quot;LS&quot;)
RBs &lt;- c(&quot;RB&quot;,&quot;FB&quot;)
TEs &lt;- c(&quot;TE&quot;)
WRs &lt;- c(&quot;WR&quot;)
QBs &lt;- c(&quot;QB&quot;)
Offense &lt;- c(QBs,RBs,WRs,TEs,O.Line)
Defense &lt;- c(D.Line,LineBackers,Safeties,CBs)
NFL.Salary.Data$SideOfBall[NFL.Salary.Data$Pos.Char %in% Offense] &lt;- &quot;Offense&quot;
NFL.Salary.Data$SideOfBall[NFL.Salary.Data$Pos.Char %in% Special.Teams] &lt;- &quot;Special Teams&quot;
NFL.Salary.Data$SideOfBall[NFL.Salary.Data$Pos.Char %in% Defense] &lt;- &quot;Defense&quot;
NFL.Salary.Data$SubTeam[NFL.Salary.Data$Pos.Char %in% Special.Teams] &lt;- &quot;Special Teams&quot;
NFL.Salary.Data$SubTeam[NFL.Salary.Data$Pos.Char %in% QBs] &lt;- &quot;Quarterbacks&quot;
NFL.Salary.Data$SubTeam[NFL.Salary.Data$Pos.Char %in% RBs] &lt;- &quot;Running Backs&quot;
NFL.Salary.Data$SubTeam[NFL.Salary.Data$Pos.Char %in% TEs] &lt;- &quot;Tight Ends&quot;
NFL.Salary.Data$SubTeam[NFL.Salary.Data$Pos.Char %in% WRs] &lt;- &quot;Wide Receivers&quot;
NFL.Salary.Data$SubTeam[NFL.Salary.Data$Pos.Char %in% O.Line] &lt;- &quot;Offensive Line&quot;
NFL.Salary.Data$SubTeam[NFL.Salary.Data$Pos.Char %in% LineBackers] &lt;- &quot;Linebackers&quot;
NFL.Salary.Data$SubTeam[NFL.Salary.Data$Pos.Char %in% CBs] &lt;- &quot;Cornerbacks&quot;
NFL.Salary.Data$SubTeam[NFL.Salary.Data$Pos.Char %in% D.Line] &lt;- &quot;Defensive Line&quot;
NFL.Salary.Data$SubTeam[NFL.Salary.Data$Pos.Char %in% Safeties] &lt;- &quot;Safeties&quot;</code></pre>
<p>That gives some positional details to the data also.</p>
</div>
</div>

    </div>

    


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="/tags/tidyverse">tidyverse</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/r">R</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/python">python</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/reticulate">reticulate</a>
  
</div>




    
    
    <div class="article-widget">
      <div class="hr-light"></div>
      <h3>Related</h3>
      <ul>
        
        <li><a href="/post/tidytuesday-tuition/">tidyTuesday - Tuition</a></li>
        
        <li><a href="/post/tidytext-is-neat/">tidytext is neat! White House Communications</a></li>
        
        <li><a href="/post/pew-data-on-bond-ratings-and-rainy-day-funds/">Pew Data on Bond Ratings and Rainy Day Funds</a></li>
        
        <li><a href="/post/mapping-with-the-government-finance-database/">Mapping with the Government Finance Database</a></li>
        
        <li><a href="/post/panel-data-r-packages/">Longitudinal Panel Data R Packages</a></li>
        
      </ul>
    </div>
    

    

    


  </div>
</article>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2018 &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/%!s(<nil>)/jquery.min.js" integrity="%!s(<nil>)" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/%!s(<nil>)/imagesloaded.pkgd.min.js" integrity="%!s(<nil>)" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/%!s(<nil>)/js/bootstrap.min.js" integrity="%!s(<nil>)" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/%!s(<nil>)/isotope.pkgd.min.js" integrity="%!s(<nil>)" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/%!s(<nil>)/jquery.fancybox.min.js" integrity="%!s(<nil>)" crossorigin="anonymous"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/%!s(<nil>)/leaflet.js" integrity="%!s(<nil>)" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/%!s(<nil>)/highlight.min.js" integrity="%!s(<nil>)" crossorigin="anonymous"></script>
      

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/%!s(<nil>)/MathJax.js?config=TeX-AMS_CHTML" integrity="%!s(<nil>)" crossorigin="anonymous"></script>
    
    

  </body>
</html>

